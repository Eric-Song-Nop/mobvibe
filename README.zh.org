* Mobvibe

Mobvibe 是一个分布式 ACP（Agent Client Protocol）WebUI，用于本地 Agent 工作流。它连接 ACP 兼容的 CLI（opencode、gemini-cli、claude-code），管理多会话对话，并在桌面和移动端提供快速、触控友好的体验。

** 主要功能

- 多会话聊天，支持实时流式更新
- 权限请求处理，内嵌决策卡片
- Slash 命令选择器（=/=）和文件资源选择器（=@=）
- 会话级文件浏览器，支持代码预览和 Tree-sitter 大纲
- 通过 Tauri v2 支持桌面和移动应用
- 浅色/深色/跟随系统主题，中英双语

** 架构

#+begin_src
┌─────────────────────────┐     Socket.io      ┌──────────────┐     Socket.io     ┌───────────────┐
│        webui            │◄──────────────────►│   gateway    │◄─────────────────►│  mobvibe-cli  │
│  (React + Tauri v2)     │    /webui ns       │  (Express)   │    /cli ns        │  (Node CLI)   │
│  Web / Desktop / Mobile │                    └──────────────┘                   └───────┬───────┘
└─────────────────────────┘                           │                                   │
                                                 REST API                           stdin/stdout
                                                 (:3005)                                  │
                                                                                  ┌───────▼───────┐
                                                                                  │   ACP CLI     │
                                                                                  │ (claude-code) │
                                                                                  └───────────────┘
#+end_src

** 前置要求

- Node.js 18+
- pnpm（包管理器）
- ACP CLI 工具：=opencode=、=gemini-cli= 或 =claude-code=

** 快速开始

#+begin_src bash
# 克隆仓库
git clone https://github.com/anthropics/mobvibe.git
cd mobvibe

# 安装依赖
pnpm install

# 启动所有服务
pnpm dev
#+end_src

服务地址：
- Gateway: http://localhost:3005
- WebUI: http://localhost:5173

** CLI 使用

*** 安装

#+begin_src bash
# 从仓库运行
cd apps/mobvibe-cli
pnpm build
./bin/mobvibe.mjs start
#+end_src

*** 命令列表

| 命令                              | 说明               |
|-----------------------------------+--------------------|
| =mobvibe start [--gateway <url>]=  | 启动守护进程       |
| =mobvibe stop=                     | 停止守护进程       |
| =mobvibe status=                   | 查看守护进程状态   |
| =mobvibe logs [-f] [-n <lines>]=   | 查看守护进程日志   |
| =mobvibe login [--webui <url>]=    | 向 gateway 认证    |
| =mobvibe logout=                   | 清除认证凭据       |
| =mobvibe auth-status=              | 查看认证状态       |

*** 配置

| 变量                    | 说明                                     |
|-------------------------+------------------------------------------|
| =MOBVIBE_GATEWAY_URL=    | Gateway URL（默认: http://localhost:3005）|
| =ANTHROPIC_AUTH_TOKEN=   | Claude Code 后端必需                     |
| =MOBVIBE_ACP_BACKENDS=   | 启用的后端列表（逗号分隔）               |

** WebUI 使用

*** Web 模式

#+begin_src bash
cd apps/webui
pnpm dev
#+end_src

访问地址：http://localhost:5173

*** 桌面模式 (Tauri)

#+begin_src bash
cd apps/webui
pnpm dev:tauri    # 开发
pnpm build:tauri  # 生产构建
#+end_src

输出：=.msi=、=.exe=（Windows），=.app=、=.dmg=（macOS），=.deb=、=.AppImage=（Linux）

*** 移动端模式 (Tauri)

#+begin_src bash
# Android（需要 Android SDK）
cd apps/webui
pnpm android:init   # 首次运行
pnpm android:dev    # 开发

# iOS（仅 macOS，需要 Xcode）
pnpm ios:init       # 首次运行
pnpm ios:dev        # 开发
#+end_src

*** 环境变量

| 变量                | 说明                                 |
|---------------------+--------------------------------------|
| =VITE_GATEWAY_URL=   | Gateway URL（未设置时自动检测）       |

** 开发

*** 脚本

| 命令          | 说明               |
|---------------+--------------------|
| =pnpm dev=     | 启动所有包         |
| =pnpm build=   | 构建所有包         |
| =pnpm lint=    | Biome lint         |
| =pnpm format=  | Biome 格式化       |
| =pnpm test=    | 运行测试（Vitest） |

*** 代码风格

- 格式化：Biome（Tab 缩进，双引号）
- TypeScript：严格模式

** 部署

参见 [[file:docs/deploy-railway-netlify.md][docs/deploy-railway-netlify.md]] 了解 Railway + Netlify 部署指南。

** 文档

- ACP 协议：https://agentclientprotocol.com/
- ACP TypeScript SDK：https://agentclientprotocol.github.io/typescript-sdk/
